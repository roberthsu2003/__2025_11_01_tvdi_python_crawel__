# 台灣銀行匯率即時查詢系統

一個美觀的桌面應用程式，用於即時顯示台灣銀行的牌告匯率資料。

![Python Version](https://img.shields.io/badge/python-3.10%2B-blue)
![License](https://img.shields.io/badge/license-MIT-green)

## ✨ 功能特色

- 🎨 **美觀的 GUI 介面**：使用 tkinter 打造現代化的使用者介面
- 🔄 **自動更新**：每10分鐘自動抓取最新匯率資料
- 📊 **完整資料顯示**：清楚展示所有幣別的現金匯率和即期匯率
- 💾 **資料儲存**：自動將匯率資料儲存為 JSON 檔案
- 🖥️ **雙模式運行**：支援 GUI 桌面應用程式和 CLI 命令列模式
- 📦 **模組化設計**：易於維護和擴展的程式架構

## 📸 應用程式截圖

```
┌─────────────────────────────────────────────────────────┐
│  🏦 台灣銀行匯率即時查詢系統                              │
├─────────────────────────────────────────────────────────┤
│  最後更新: 2025-12-12 14:06:32          🔄 手動更新      │
│                                                          │
│  ┌──────────────────────────────────────────────────┐  │
│  │  幣名    │ 現金買入 │ 現金賣出 │ 即期買入 │ 即期賣出 │  │
│  ├──────────────────────────────────────────────────┤  │
│  │ 美金(USD) │  30.79  │  31.46  │  31.14  │  31.24  │  │
│  │ 港幣(HKD) │  3.851  │  4.055  │  3.977  │  4.037  │  │
│  │ 英鎊(GBP) │  40.59  │  42.71  │  41.60  │  42.00  │  │
│  │ 日圓(JPY) │  0.191  │  0.204  │  0.198  │  0.202  │  │
│  │ ...       │   ...   │   ...   │   ...   │   ...   │  │
│  └──────────────────────────────────────────────────┘  │
│                                                          │
│  ☑ ⏰ 自動更新（每10分鐘）                                │
├─────────────────────────────────────────────────────────┤
│  ● 已連線 | 共 19 筆匯率資料                             │
└─────────────────────────────────────────────────────────┘
```

## 🚀 快速開始

### 系統需求

- Python 3.10 或更高版本
- macOS / Windows / Linux

### 安裝步驟

1. **Clone 專案**

```bash
cd /Users/roberthsu2003/Documents/GitHub/2025_11_01_tvdi_python_crawel/learning2
```

2. **安裝相依套件**

```bash
pip install crawl4ai
```

或如果有 requirements.txt:

```bash
pip install -r requirements.txt
```

3. **執行應用程式**

**GUI 模式（推薦）：**
```bash
python gui_app.py
```

**CLI 模式：**
```bash
python main.py
```

## 📖 使用說明

### GUI 桌面應用程式

1. **啟動應用程式**：執行 `python gui_app.py`
2. **查看匯率**：應用程式啟動時會自動載入最新匯率資料
3. **手動更新**：點擊「🔄 手動更新」按鈕可立即更新資料
4. **自動更新**：勾選「⏰ 自動更新（每10分鐘）」選項啟用自動更新功能
5. **查看狀態**：底部狀態列顯示連線狀態和資料筆數

### CLI 命令列模式

1. **啟動程式**：執行 `python main.py`
2. **自動運行**：程式會每10分鐘自動抓取並儲存匯率資料
3. **停止程式**：按 `Ctrl+C` 終止程式

### 資料儲存

所有抓取的匯率資料都會自動儲存在 `data/` 目錄下，檔案命名格式為：

```
台幣匯率_YYYYMMDD_HHMMSS.json
```

例如：`台幣匯率_20251212_140632.json`

## 📁 專案架構

```
learning2/
├── crawler_module.py      # 爬蟲核心模組
│   └── ExchangeRateCrawler 類別
│
├── gui_app.py            # GUI 桌面應用程式
│   └── ExchangeRateApp 類別
│
├── main.py               # CLI 命令列版本
│
├── README.md             # 專案說明文件
│
└── data/                 # 資料儲存目錄
    └── *.json           # 匯率資料檔案
```

### 模組說明

#### `crawler_module.py`
提供爬蟲核心功能的獨立模組：
- `ExchangeRateCrawler` 類別：封裝所有爬蟲邏輯
- `fetch_exchange_rates()` 方法：異步抓取匯率資料
- `save_to_json()` 方法：儲存資料到 JSON 檔案

#### `gui_app.py`
GUI 桌面應用程式：
- 使用 tkinter + ttk 建立美觀介面
- 支援手動和自動更新
- 背景執行緒避免介面凍結
- 即時狀態顯示

#### `main.py`
命令列版本：
- 簡單的 CLI 介面
- 每10分鐘自動更新
- 詳細的執行日誌

## 🛠️ 技術棧

- **Python**: 3.10+
- **GUI 框架**: tkinter + ttk
- **網頁爬蟲**: crawl4ai
- **異步處理**: asyncio
- **多執行緒**: threading
- **資料格式**: JSON

## 📊 資料來源

本專案抓取的資料來自 [台灣銀行牌告匯率](https://rate.bot.com.tw/xrt?Lang=zh-TW)。

### 資料欄位

每筆匯率資料包含以下欄位：

- **幣名**：貨幣名稱（例如：美金 (USD)）
- **現金匯率_本行買入**：現金買入價格
- **現金匯率_本行賣出**：現金賣出價格
- **即期匯率_本行買入**：即期買入價格
- **即期匯率_本行賣出**：即期賣出價格

## 🔧 開發指南

### 修改更新頻率

在 `gui_app.py` 或 `main.py` 中修改以下行：

```python
# 600 秒 = 10 分鐘
await asyncio.sleep(600)
```

改為你想要的秒數，例如 5 分鐘：

```python
await asyncio.sleep(300)  # 5 分鐘
```

### 客製化 GUI 外觀

在 `gui_app.py` 的 `_setup_styles()` 方法中修改配色方案：

```python
self.colors = {
    'primary': '#2c3e50',      # 深藍灰
    'secondary': '#34495e',    # 中藍灰
    'accent': '#3498db',       # 亮藍
    # ... 其他顏色
}
```

## ⚠️ 注意事項

- 本專案僅供學習和個人使用
- 請遵守台灣銀行網站的使用條款
- 爬蟲頻率請適度，避免對伺服器造成負擔
- 匯率資料僅供參考，實際交易請以銀行公告為準

## 📝 授權資訊

本專案採用 MIT 授權條款。

## 👨‍💻 作者

Robert Hsu

## 🤝 貢獻

歡迎提交 Issue 或 Pull Request！

## 📞 聯絡方式

如有任何問題或建議，歡迎透過 GitHub Issues 聯繫。

---

**享受使用台灣銀行匯率即時查詢系統！** 🎉
